<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 LAB Prático NO R: Análise Exploratória Longitudinal | PTE-3121 - Planejamento e Análise de Pesquisas Longitudinais</title>
  <meta name="description" content="14 LAB Prático NO R: Análise Exploratória Longitudinal | PTE-3121 - Planejamento e Análise de Pesquisas Longitudinais" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="14 LAB Prático NO R: Análise Exploratória Longitudinal | PTE-3121 - Planejamento e Análise de Pesquisas Longitudinais" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 LAB Prático NO R: Análise Exploratória Longitudinal | PTE-3121 - Planejamento e Análise de Pesquisas Longitudinais" />
  
  
  

<meta name="author" content="Professora Alinne Veiga" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="referências-e-leituras-sugeridas-para-essa-aula.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="panorama-da-aula.html"><a href="panorama-da-aula.html"><i class="fa fa-check"></i><b>1</b> Panorama da Aula</a></li>
<li class="chapter" data-level="2" data-path="análise-exploratória-de-dados-longitudinais.html"><a href="análise-exploratória-de-dados-longitudinais.html"><i class="fa fa-check"></i><b>2</b> Análise Exploratória de Dados Longitudinais</a></li>
<li class="chapter" data-level="3" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html"><i class="fa fa-check"></i><b>3</b> Organizando o banco de dados longitudinal</a><ul>
<li class="chapter" data-level="3.1" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#dados-em-nível-pessoa-wide-largo"><i class="fa fa-check"></i><b>3.1</b> Dados em nível pessoa (wide) (largo)</a></li>
<li class="chapter" data-level="3.2" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#dados-em-nível-pessoa-tempo-long-longo"><i class="fa fa-check"></i><b>3.2</b> Dados em nível pessoa-tempo (long) (longo)</a></li>
<li class="chapter" data-level="3.3" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#objetivo"><i class="fa fa-check"></i><b>3.3</b> Objetivo</a></li>
<li class="chapter" data-level="3.4" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#identificando-relações-longitudinais-e-de-corte-transversal"><i class="fa fa-check"></i><b>3.4</b> Identificando relações longitudinais e de corte-transversal</a></li>
<li class="chapter" data-level="3.5" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#medindo-o-tempo"><i class="fa fa-check"></i><b>3.5</b> Medindo o tempo</a></li>
<li class="chapter" data-level="3.6" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#tipos-de-não-resposta-em-banco-de-dados-longitudinais"><i class="fa fa-check"></i><b>3.6</b> Tipos de Não resposta em banco de dados longitudinais</a></li>
<li class="chapter" data-level="3.7" data-path="organizando-o-banco-de-dados-longitudinal.html"><a href="organizando-o-banco-de-dados-longitudinal.html#notação-importante-em-dados-de-medidas-repetidas"><i class="fa fa-check"></i><b>3.7</b> Notação Importante em dados de medidas repetidas</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="análise-gráfica.html"><a href="análise-gráfica.html"><i class="fa fa-check"></i><b>4</b> Análise Gráfica</a></li>
<li class="chapter" data-level="5" data-path="exemplo-diggle-et-all-respostas-contra-o-tempo-com-observações-conectadas-crescimento-de-porcos.html"><a href="exemplo-diggle-et-all-respostas-contra-o-tempo-com-observações-conectadas-crescimento-de-porcos.html"><i class="fa fa-check"></i><b>5</b> Exemplo Diggle et.all: respostas contra o tempo com observações conectadas – Crescimento de Porcos</a></li>
<li class="chapter" data-level="6" data-path="exemplo-alda-book.html"><a href="exemplo-alda-book.html"><i class="fa fa-check"></i><b>6</b> Exemplo: ALDA Book</a><ul>
<li class="chapter" data-level="6.1" data-path="exemplo-alda-book.html"><a href="exemplo-alda-book.html#gráficos-de-crescimento"><i class="fa fa-check"></i><b>6.1</b> Gráficos de Crescimento</a></li>
<li class="chapter" data-level="6.2" data-path="exemplo-alda-book.html"><a href="exemplo-alda-book.html#gráficos-de-crescimento-com-pontos-conectados-trajetórias"><i class="fa fa-check"></i><b>6.2</b> Gráficos de Crescimento com pontos conectados (trajetórias)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gráficos-de-crescimento-suavizados.html"><a href="gráficos-de-crescimento-suavizados.html"><i class="fa fa-check"></i><b>7</b> Gráficos de crescimento suavizados:</a></li>
<li class="chapter" data-level="8" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html"><i class="fa fa-check"></i><b>8</b> Exemplo: BHPS</a><ul>
<li class="chapter" data-level="8.1" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#bhps-taxa-de-resposta-nas-ondas-de-1-a-10"><i class="fa fa-check"></i><b>8.1</b> BHPS: Taxa de resposta nas ondas de 1 a 10</a></li>
<li class="chapter" data-level="8.2" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#efeito-da-não-resposta-de-unidade"><i class="fa fa-check"></i><b>8.2</b> Efeito da não-resposta de unidade</a></li>
<li class="chapter" data-level="8.3" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#pesos-amostrais"><i class="fa fa-check"></i><b>8.3</b> Pesos amostrais</a></li>
<li class="chapter" data-level="8.4" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#gráfico-de-dispersão-com-os-primeiros-50-indivíduos"><i class="fa fa-check"></i><b>8.4</b> Gráfico de dispersão com os primeiros 50 indivíduos</a></li>
<li class="chapter" data-level="8.5" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#gráfico-de-dispersão-com-os-primeiros-50-indivíduos-por-grupo-de-idade"><i class="fa fa-check"></i><b>8.5</b> Gráfico de dispersão com os primeiros 50 indivíduos por grupo de idade</a></li>
<li class="chapter" data-level="8.6" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#box-plot-das-respostas-por-ano-e-por-gênero"><i class="fa fa-check"></i><b>8.6</b> Box plot das respostas por ano e por gênero</a></li>
<li class="chapter" data-level="8.7" data-path="exemplo-bhps.html"><a href="exemplo-bhps.html#média-e-intervalo-de-confiança-de-95-por-gênero"><i class="fa fa-check"></i><b>8.7</b> Média e intervalo de confiança de 95% por gênero</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="outros-gráficos.html"><a href="outros-gráficos.html"><i class="fa fa-check"></i><b>9</b> Outros Gráficos</a><ul>
<li class="chapter" data-level="9.1" data-path="outros-gráficos.html"><a href="outros-gráficos.html#explorando-a-estrutura-de-correlação"><i class="fa fa-check"></i><b>9.1</b> Explorando a estrutura de correlação</a></li>
<li class="chapter" data-level="9.2" data-path="outros-gráficos.html"><a href="outros-gráficos.html#gráfico-da-matriz-de-correlação"><i class="fa fa-check"></i><b>9.2</b> Gráfico da matriz de correlação</a></li>
<li class="chapter" data-level="9.3" data-path="outros-gráficos.html"><a href="outros-gráficos.html#matriz-de-correlação-dos-resíduos"><i class="fa fa-check"></i><b>9.3</b> Matriz de correlação dos resíduos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exemplo-da-alda.html"><a href="exemplo-da-alda.html"><i class="fa fa-check"></i><b>10</b> Exemplo da ALDA:</a><ul>
<li class="chapter" data-level="10.1" data-path="exemplo-da-alda.html"><a href="exemplo-da-alda.html#matriz-de-correlação-entre-as-respostas"><i class="fa fa-check"></i><b>10.1</b> Matriz de correlação entre as respostas</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html"><i class="fa fa-check"></i><b>11</b> Exemplo da WEISS: BIG MICE</a><ul>
<li class="chapter" data-level="11.1" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#box-plot"><i class="fa fa-check"></i><b>11.1</b> Box-plot</a></li>
<li class="chapter" data-level="11.2" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#trajetórias-suavizadas"><i class="fa fa-check"></i><b>11.2</b> Trajetórias suavizadas</a></li>
<li class="chapter" data-level="11.3" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#trajetórias-individuais"><i class="fa fa-check"></i><b>11.3</b> Trajetórias individuais</a></li>
<li class="chapter" data-level="11.4" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#trajetórias-individuais-para-ratos-selecionados"><i class="fa fa-check"></i><b>11.4</b> Trajetórias individuais para ratos selecionados</a></li>
<li class="chapter" data-level="11.5" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#suavização-e-quantis"><i class="fa fa-check"></i><b>11.5</b> suavização e quantis</a></li>
<li class="chapter" data-level="11.6" data-path="exemplo-da-weiss-big-mice.html"><a href="exemplo-da-weiss-big-mice.html#correlação"><i class="fa fa-check"></i><b>11.6</b> Correlação</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="em-resumo.html"><a href="em-resumo.html"><i class="fa fa-check"></i><b>12</b> Em resumo:</a></li>
<li class="chapter" data-level="13" data-path="referências-e-leituras-sugeridas-para-essa-aula.html"><a href="referências-e-leituras-sugeridas-para-essa-aula.html"><i class="fa fa-check"></i><b>13</b> Referências e Leituras sugeridas para essa aula</a></li>
<li class="chapter" data-level="14" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html"><i class="fa fa-check"></i><b>14</b> LAB Prático NO R: Análise Exploratória Longitudinal</a><ul>
<li class="chapter" data-level="14.1" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#exemplo-do-livro-applied-longitudinal-data-analysis-modeling-change-and-event-occurrence-por-singer-willet"><i class="fa fa-check"></i><b>14.1</b> Exemplo do livro: Applied Longitudinal Data Analysis: Modeling Change and Event Occurrence por Singer &amp; Willet</a><ul>
<li class="chapter" data-level="14.1.1" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#olhando-os-dados-dados-nível-pessoa-vs-pessoa-período"><i class="fa fa-check"></i><b>14.1.1</b> Olhando os dados: dados nível pessoa vs pessoa-período</a></li>
<li class="chapter" data-level="14.1.2" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#verificando-a-correlação-entre-os-dados"><i class="fa fa-check"></i><b>14.1.2</b> Verificando a correlação entre os dados</a></li>
<li class="chapter" data-level="14.1.3" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#plotando-as-trajetórias"><i class="fa fa-check"></i><b>14.1.3</b> Plotando as trajetórias</a></li>
<li class="chapter" data-level="14.1.4" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#plotando-as-trajetórias-de-acordo-com-subgrupos"><i class="fa fa-check"></i><b>14.1.4</b> Plotando as trajetórias de acordo com subgrupos</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="lab-prático-no-r-análise-exploratória-longitudinal.html"><a href="lab-prático-no-r-análise-exploratória-longitudinal.html#exemplo-do-livro-modeling-longitudinal-data-por-robert-weiss"><i class="fa fa-check"></i><b>14.2</b> Exemplo do livro: Modeling Longitudinal Data por Robert Weiss</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PTE-3121 - Planejamento e Análise de Pesquisas Longitudinais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab-prático-no-r-análise-exploratória-longitudinal" class="section level1">
<h1><span class="header-section-number">14</span> LAB Prático NO R: Análise Exploratória Longitudinal</h1>
<blockquote>
<blockquote>
<p>Abra o Rstudio</p>
</blockquote>
</blockquote>
<p>Iremos utilizar os exemplos dos livros de <em>Singer</em> e <em>Weiis</em>, materiais encontrados na web nos respectivos endereços:</p>
<ul>
<li><p><a href="https://stats.idre.ucla.edu/r/examples/alda/r-applied-longitudinal-data-analysis-ch-2/" class="uri">https://stats.idre.ucla.edu/r/examples/alda/r-applied-longitudinal-data-analysis-ch-2/</a></p></li>
<li><p><a href="https://stats.idre.ucla.edu/stata/examples/mld-weiss/modeling-longitudinal-data-by-robert-weisschapter-2-plots/" class="uri">https://stats.idre.ucla.edu/stata/examples/mld-weiss/modeling-longitudinal-data-by-robert-weisschapter-2-plots/</a></p></li>
</ul>
<div id="exemplo-do-livro-applied-longitudinal-data-analysis-modeling-change-and-event-occurrence-por-singer-willet" class="section level2">
<h2><span class="header-section-number">14.1</span> Exemplo do livro: Applied Longitudinal Data Analysis: Modeling Change and Event Occurrence por Singer &amp; Willet</h2>
<p>Dados de cinco ondas da pesquisa <em>National Youth Survey</em>. Os participantes tem idade de 11 a 15 anos e perguntam sobre sua tolerância em relação à comportamento ruim. Uma escala de 4 pontos é utilizada para medir a tolerância - 1 sendo “muito errado” e 4 sendo “nada errado”. Perguntas são do tipo <em>é errado: usar maconha?, destruir propriedade de outras pessoas?, roubar algo de pequeno valor?, ameaçar alguém sem razão?, usar alcool?, etc…</em>. A variável resposta é a média do escore para todas as perguntas e ainda há as variáveis: sexo (homens), Exposure (se foram expostos à algum desses comportamentos aos 11 anos) - maiores detalhes, consultar o livro.</p>
<div id="olhando-os-dados-dados-nível-pessoa-vs-pessoa-período" class="section level3">
<h3><span class="header-section-number">14.1.1</span> Olhando os dados: dados nível pessoa vs pessoa-período</h3>
<p>Vamos, inicialmnete utilizar a base de dados em formato “nível-pessoa” (wide) e realizar o reshape para transformar em formato longo</p>
<p>A base de dados está disponível na internet. Digite a sequência de comandos:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2">tolerance &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;tolerance1.txt&quot;</span>) </a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">print</span>(tolerance)</a></code></pre></div>
<blockquote>
<p>Olhe para os seus dados. <strong>O que você pode ver?</strong> Há muitas mudanças ao longo do tempo?</p>
</blockquote>
<p>Para passar para o formato longo utilizamos a função <code>reshape</code> .</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">## Wide to long</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">tolerance.pp &lt;-<span class="st"> </span><span class="kw">reshape</span>(tolerance, </a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="dt">varying =</span> <span class="kw">c</span>(<span class="st">&quot;tol11&quot;</span>, <span class="st">&quot;tol12&quot;</span>, <span class="st">&quot;tol13&quot;</span>, <span class="st">&quot;tol14&quot;</span>, <span class="st">&quot;tol15&quot;</span>), </a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="dt">v.names =</span> <span class="st">&quot;tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="dt">timevar =</span> <span class="st">&quot;time&quot;</span>, </a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="dt">new.row.names =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>)</a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">tolerance.pp &lt;-<span class="st"> </span>tolerance.pp[<span class="kw">order</span>(tolerance.pp<span class="op">$</span>id),]</a>
<a class="sourceLine" id="cb2-13" title="13">tolerance.pp[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a></code></pre></div>
<p>Também podemos partir do formato longo para o formato largo.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">## Long to wide</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">tolerance.w &lt;-<span class="st"> </span><span class="kw">reshape</span>(tolerance.pp, </a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="dt">timevar =</span> <span class="st">&quot;time&quot;</span>,</a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="dt">idvar =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;exposure&quot;</span>),</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>)</a>
<a class="sourceLine" id="cb3-7" title="7">  </a>
<a class="sourceLine" id="cb3-8" title="8">tolerance.w[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">dim</span>(tolerance.w)</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="kw">dim</span>(tolerance)</a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># compare!</span></a></code></pre></div>
</div>
<div id="verificando-a-correlação-entre-os-dados" class="section level3">
<h3><span class="header-section-number">14.1.2</span> Verificando a correlação entre os dados</h3>
<p>Um dos pontos bem reforçados na aula foi que <em>em dados longitudinais espera-se que as medidas repetidas de um mesmo indivíduo sejam positivamente correlacionadas</em>. Podemos verificar essa correlação de forma numérica e gráfica. Para isso (e somente isso) utilizamos o banco em formato largo.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">cor</span>(tolerance[ , <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">pairs</span>(<span class="op">~</span>tol11<span class="op">+</span>tol12<span class="op">+</span>tol13<span class="op">+</span>tol14<span class="op">+</span>tol15,<span class="dt">data=</span>tolerance)</a></code></pre></div>
<p>Ainda não temos uma ideia completa de como a variável resposta muda com o tempo. Existe alguma correlação positiva entre esses dados - embora fraca - e não parece existir um padrão estabelecido na correlação.
Podemos dizer, no entanto, que adolescentes que tinham comportamento mais tolerável em uma onda, tendem a continuar toleráveis na onda seguinte. Ainda não temos como verificar como cada pessoa muda com o tempo.</p>
<p>Correlação entre as medidas não nos diz nada sobre mudança no tempo. Precisamos verificar os gráficos de crescimento.</p>
</div>
<div id="plotando-as-trajetórias" class="section level3">
<h3><span class="header-section-number">14.1.3</span> Plotando as trajetórias</h3>
<p>Para plotar o gráfico com as curvas de crescimento - trajetórias - podemos utilizar o comando <code>xyplot</code>. Também utilizaremos esse comando para plotar as trajetórias suavizadas. Para saber mais detalhes sobre esse comando, visite o endereço:</p>
<ul>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/lattice/html/xyplot.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/lattice/html/xyplot.html</a></li>
</ul>
<p>Note que, para os gráficos de crescimento, precisamos utilizar o arquivo em formato pessoa-período. Não temos a variável <code>age</code> e temos que criá-la. O objetivo aqui é observar as 16 trajetórias e tentar responder a pergunta de <em>como as pessoas mudam com o tempo?</em> A ideia é plotar todas as trajetórias numa única página para facilitar a observação - mantendo todos os gráficos na mesma escala.</p>
<p>Tente responder:</p>
<ul>
<li><p>Tolerância aumenta com a idade?</p></li>
<li><p>Quais indivíduos possuem trajetórias diferentes dos demais?</p></li>
<li><p>A tolerância muda bastante com o tempo ou é relativamente estável?</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(lattice)  </a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">tolerance.pp<span class="op">$</span>age&lt;-(tolerance.pp<span class="op">$</span>time<span class="op">+</span><span class="dv">1</span>)<span class="op">+</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">xyplot</span>(tolerance <span class="op">~</span><span class="st"> </span>age <span class="op">|</span><span class="st"> </span>id, <span class="dt">data=</span>tolerance.pp, <span class="dt">as.table=</span>T)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">## Utilizando a suavização</span></a>
<a class="sourceLine" id="cb5-9" title="9"></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="kw">xyplot</span>(tolerance<span class="op">~</span>age <span class="op">|</span><span class="st"> </span>id, <span class="dt">data=</span>tolerance.pp,</a>
<a class="sourceLine" id="cb5-11" title="11">      <span class="dt">prepanel =</span> <span class="cf">function</span>(x, y) <span class="kw">prepanel.loess</span>(x, y, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>),</a>
<a class="sourceLine" id="cb5-12" title="12">      <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb5-13" title="13">      <span class="dt">panel =</span> <span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb5-14" title="14">      <span class="kw">panel.xyplot</span>(x, y)</a>
<a class="sourceLine" id="cb5-15" title="15">      <span class="kw">panel.loess</span>(x,y, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>) },</a>
<a class="sourceLine" id="cb5-16" title="16">      <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">as.table=</span>T)</a>
<a class="sourceLine" id="cb5-17" title="17"></a>
<a class="sourceLine" id="cb5-18" title="18"></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="kw">xyplot</span>(tolerance<span class="op">~</span>age <span class="op">|</span><span class="st"> </span>id, <span class="dt">data=</span>tolerance.pp,</a>
<a class="sourceLine" id="cb5-20" title="20">      <span class="dt">prepanel =</span> <span class="cf">function</span>(x, y) <span class="kw">prepanel.loess</span>(x, y, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>),</a>
<a class="sourceLine" id="cb5-21" title="21">      <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb5-22" title="22">      <span class="dt">panel =</span> <span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb5-23" title="23">      <span class="kw">panel.xyplot</span>(x, y)</a>
<a class="sourceLine" id="cb5-24" title="24">      <span class="kw">panel.loess</span>(x,y, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>) },</a>
<a class="sourceLine" id="cb5-25" title="25">      <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),<span class="dt">aspect =</span> <span class="st">&quot;xy&quot;</span>)</a>
<a class="sourceLine" id="cb5-26" title="26"></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="kw">attach</span>(tolerance.pp)</a></code></pre></div>
<ul>
<li>Considerando agora os gráficos com as trajetórias suavizadas, o que se oberva sobre as trajetórias individuais? Há três formatos básicos de trajetórias, identifique-os.</li>
</ul>
</div>
<div id="plotando-as-trajetórias-de-acordo-com-subgrupos" class="section level3">
<h3><span class="header-section-number">14.1.4</span> Plotando as trajetórias de acordo com subgrupos</h3>
<p>Primeiramente iremos plotar as trajetórias totais: trajetórias não paramétricas e paramétricas através de regressões por mínimos quadrados.</p>
<p>Há duas maneiras de se fazer isso: utilizando o comando <code>xyplot</code> ou o comando <code>interaction.plot</code> . São equivalentes. Faça os gráficos e:</p>
<ul>
<li><p>Dê um resumo de como se comporta a tolerância de cada indivíduo e na média.</p></li>
<li><p>É correto afirmar que conforme os adoslecentes ficam mais maduros, eles ficam mais toleráveis?</p></li>
<li><p>O padrão de mudança é homogêneo ou heterogêneo?</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">## Os dados brutos - Geral</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># Trajetórias não paramétricas</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">interaction.plot</span>(tolerance.pp<span class="op">$</span>age, tolerance.pp<span class="op">$</span>id, tolerance.pp<span class="op">$</span>tolerance) </a>
<a class="sourceLine" id="cb6-7" title="7"></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb6-9" title="9">       </a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw">xyplot</span>(tolerance <span class="op">~</span><span class="st"> </span>age , <span class="dt">data=</span>tolerance.pp, <span class="dt">groups =</span> id,  <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb6-11" title="11">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),   <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>) )</a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co"># compare sem os grupos -- trajetórias médias suavizadas</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="kw">xyplot</span>(tolerance <span class="op">~</span><span class="st"> </span>age , <span class="dt">data=</span>tolerance.pp, <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb6-16" title="16">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">type =</span><span class="kw">c</span>(  <span class="st">&quot;smooth&quot;</span>) , <span class="dt">lwd =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-17" title="17"></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">## Trajetórias paramétricas</span></a>
<a class="sourceLine" id="cb6-19" title="19"></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co"># Primeiro ajusta-se regressões OLS para cada indivíduo</span></a>
<a class="sourceLine" id="cb6-21" title="21">fit &lt;-<span class="st"> </span><span class="kw">by</span>(tolerance.pp, tolerance.pp<span class="op">$</span>id, <span class="cf">function</span>(bydata) </a>
<a class="sourceLine" id="cb6-22" title="22">  <span class="kw">fitted.values</span>(<span class="kw">lm</span>(tolerance <span class="op">~</span><span class="st"> </span>time, <span class="dt">data=</span>bydata))) </a>
<a class="sourceLine" id="cb6-23" title="23">fit &lt;-<span class="st"> </span><span class="kw">unlist</span>(fit)</a>
<a class="sourceLine" id="cb6-24" title="24"></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co"># As trajetórias</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="kw">interaction.plot</span>(age, id, fit, <span class="dt">xlab=</span><span class="st">&quot;age&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;tolerance&quot;</span>)</a>
<a class="sourceLine" id="cb6-27" title="27"></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb6-29" title="29"></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="kw">xyplot</span>(tolerance <span class="op">~</span><span class="st"> </span>age , <span class="dt">data=</span>tolerance.pp, <span class="dt">groups =</span> id,  <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb6-31" title="31">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),   <span class="dt">type =</span> <span class="st">&quot;r&quot;</span> )</a>
<a class="sourceLine" id="cb6-32" title="32"></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co"># trajetória média</span></a>
<a class="sourceLine" id="cb6-34" title="34"></a>
<a class="sourceLine" id="cb6-35" title="35"></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="kw">xyplot</span>(tolerance <span class="op">~</span><span class="st"> </span>age , <span class="dt">data=</span>tolerance.pp,   <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tolerance&quot;</span>,</a>
<a class="sourceLine" id="cb6-37" title="37">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),   <span class="dt">type =</span> <span class="st">&quot;r&quot;</span> , <span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p>Agora iremos realizar um gráfico parecido com o anterior, mas considerando os homens apenas. Depois replique os mesmos comandos para mulheres (identifique o que precisa modificar no código);</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">## Para Homens</span></a>
<a class="sourceLine" id="cb7-2" title="2">tolm &lt;-<span class="st"> </span>tolerance.pp[tolerance.pp<span class="op">$</span>male<span class="op">==</span><span class="dv">0</span> , ]</a>
<a class="sourceLine" id="cb7-3" title="3">fitmlist &lt;-<span class="st"> </span><span class="kw">by</span>(tolm, tolm<span class="op">$</span>id, <span class="cf">function</span>(bydata) </a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="kw">fitted.values</span>(<span class="kw">lm</span>(tolerance <span class="op">~</span><span class="st"> </span>time, <span class="dt">data=</span>bydata))) </a>
<a class="sourceLine" id="cb7-5" title="5">fitm &lt;-<span class="st"> </span><span class="kw">unlist</span>(fitmlist)</a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## Juntando a média para todo o grupo</span></a>
<a class="sourceLine" id="cb7-8" title="8">lm.m &lt;-<span class="st"> </span><span class="kw">fitted</span>( <span class="kw">lm</span>(tolerance <span class="op">~</span><span class="st"> </span>time, <span class="dt">data=</span>tolm) )</a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw">names</span>(lm.m) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb7-10" title="10">fit.m2 &lt;-<span class="st"> </span><span class="kw">c</span>(fitm, lm.m[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb7-11" title="11">age.m &lt;-<span class="st"> </span><span class="kw">c</span>(tolm<span class="op">$</span>age, <span class="kw">seq</span>(<span class="dv">11</span>,<span class="dv">15</span>))</a>
<a class="sourceLine" id="cb7-12" title="12">id.m &lt;-<span class="st"> </span><span class="kw">c</span>(tolm<span class="op">$</span>id, <span class="kw">rep</span>(<span class="dv">111</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">## O gráfico </span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co"># id.m=111representa o valor médio</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="kw">interaction.plot</span>(age.m, id.m, fit.m2, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">xlab=</span><span class="st">&quot;AGE&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;TOLERANCE&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-17" title="17"><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;Males&quot;</span>)</a></code></pre></div>
<p>E para mulheres? Quais os comandos você usaria para gerar o gráfico a seguir?</p>
<p><img src="Aula2_Book-ComLab-_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Compare os gráficos e tente identificar:</p>
<ul>
<li><p>As trajetórias diferem entre grupos?</p></li>
<li><p>Onde estão as maiores diferenças? No estado inicial ou na inclinação?</p></li>
<li><p>Tem algum grupo com trajetórias mais ou menos heterogêneas?</p></li>
</ul>
</div>
</div>
<div id="exemplo-do-livro-modeling-longitudinal-data-por-robert-weiss" class="section level2">
<h2><span class="header-section-number">14.2</span> Exemplo do livro: Modeling Longitudinal Data por Robert Weiss</h2>
<p>A mesma análise feita anteriormente pode ser repetida para qualquer banco de dados longitudinal. Nessa seção iremos utilizar uma base de dados não balanceada com pesos de ratos medidos ao nascer. A variável dia representa em que dia eles foram pesados. Esse exemplo é do artigo com o título “A class of linear spectral models and analyses for the study of longitudinal data” por Izenman AJ e Williams JS (1989). Esses dados foram utilizados no capítulo 2 do livro “Modeling Longitudinal Data” por Robert Weiss. Vamos, no entanto, seguir a abordagem sugerida por Diggle, et.all.</p>
<p>Note que os códigos são um pouco mais complexos e por isso eles estão disponíveis num script do R com o nome <code>"ScriptWeissMice"</code>.</p>
<p>A variável resposta é a variável “weight” e a variável de tempo é a variável “time”. No banco de dados também tem o <code>id</code> de cada ratinho e uma variável de grupo (data da pesagem) (Ver livro página 30).</p>
<p>Digite os comandos no R (ou copie e cole do txt). Verifique o output e se faça as mesmas perguntas do exemplo anterior, por exemplo:</p>
<ul>
<li><p>Há muitas mudanças ao longo do tempo?</p></li>
<li><p>Como os ratinhos mudam com o tempo?</p></li>
<li><p>O peso aumenta com os dias?</p></li>
<li><p>Quais os ratinhos possuem trajetórias diferentes dos demais?</p></li>
<li><p>Dê um resumo de como se comporta o peso de cada rato e na média.</p></li>
<li><p>O padrão de mudança é homogêneo ou heterogêneo?</p></li>
<li><p>As trajetórias diferem entre grupos?</p></li>
<li><p>Onde estão as maiores diferenças? No estado inicial ou na inclinação?</p></li>
<li><p>Tem algum grupo com trajetórias mais ou menos heterogêneas?</p></li>
<li><p>Como está a correlação para as respostas dos ratinhos?</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">## Lendo os dados</span></a>
<a class="sourceLine" id="cb8-3" title="3">mice &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;mice.dat&quot;</span>,<span class="dt">header=</span>T)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">## Olhando a base</span></a>
<a class="sourceLine" id="cb8-6" title="6">mice[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">plot</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time,<span class="dt">data =</span> mice, <span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>,</a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="dt">ylab=</span><span class="st">&quot;Weight&quot;</span>)</a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">## Gráficos de curvas de crescimento</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">library</span>(lattice)  </a>
<a class="sourceLine" id="cb8-13" title="13"><span class="kw">xyplot</span>(mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time , <span class="dt">data=</span>mice, <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>)</a>
<a class="sourceLine" id="cb8-14" title="14"></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">## Box-plot</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="kw">bwplot</span> (mice<span class="op">$</span>time <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>wt , <span class="dt">data=</span>mice)</a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">## Trajetórias</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#trajetória média</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="kw">xyplot</span>(mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time , <span class="dt">data=</span>mice, <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="dt">type=</span><span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb8-21" title="21"></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#trajetória suavizada</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="kw">xyplot</span>(mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time , <span class="dt">data=</span>mice, <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="dt">type=</span><span class="st">&quot;smooth&quot;</span>)</a>
<a class="sourceLine" id="cb8-24" title="24"></a>
<a class="sourceLine" id="cb8-25" title="25"></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#outra maneira de plotar trajetórias suavizadas</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="kw">plot</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time, <span class="dt">data =</span> mice, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>,</a>
<a class="sourceLine" id="cb8-28" title="28">      <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>,</a>
<a class="sourceLine" id="cb8-29" title="29">      <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</a>
<a class="sourceLine" id="cb8-30" title="30"><span class="kw">with</span> (mice, {</a>
<a class="sourceLine" id="cb8-31" title="31">  <span class="kw">lines</span> (<span class="kw">ksmooth</span> ( mice<span class="op">$</span>time, mice<span class="op">$</span>wt, <span class="dt">kernel =</span> <span class="st">&quot;box&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb8-32" title="32">         <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-33" title="33">  <span class="kw">lines</span> (<span class="kw">ksmooth</span> ( mice<span class="op">$</span>time, mice<span class="op">$</span>wt, <span class="dt">kernel =</span> <span class="st">&quot;normal&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb8-34" title="34">         <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-35" title="35">  <span class="kw">lines</span> (<span class="kw">loess.smooth</span> ( mice<span class="op">$</span>time, mice<span class="op">$</span>wt, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>),</a>
<a class="sourceLine" id="cb8-36" title="36">         <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-37" title="37">  <span class="kw">lines</span> (<span class="kw">smooth.spline</span> ( mice<span class="op">$</span>time, mice<span class="op">$</span>wt), <span class="dt">lty =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-38" title="38">  <span class="kw">lines</span> (<span class="kw">supsmu</span> (mice<span class="op">$</span>time, mice<span class="op">$</span>wt), <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-39" title="39">})</a>
<a class="sourceLine" id="cb8-40" title="40"><span class="kw">legend</span> (<span class="dv">0</span>, <span class="dv">1210</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Boxcar&quot;</span>, <span class="st">&quot;Gaussian Kernel&quot;</span>, <span class="st">&quot;Gaussian Loess&quot;</span>,</a>
<a class="sourceLine" id="cb8-41" title="41">                           <span class="st">&quot;Cubic Smooth Spline&quot;</span>, <span class="st">&quot;Super Smoother&quot;</span>),<span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-42" title="42"></a>
<a class="sourceLine" id="cb8-43" title="43"></a>
<a class="sourceLine" id="cb8-44" title="44"><span class="co">## Trajetórias por ID</span></a>
<a class="sourceLine" id="cb8-45" title="45"><span class="kw">xyplot</span>(mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time , <span class="dt">data=</span>mice, <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">groups=</span>id)</a>
<a class="sourceLine" id="cb8-46" title="46"></a>
<a class="sourceLine" id="cb8-47" title="47"><span class="kw">xyplot</span>(mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time<span class="op">|</span><span class="st"> </span>id , <span class="dt">data=</span>mice, <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>,  <span class="dt">groups=</span>id)</a>
<a class="sourceLine" id="cb8-48" title="48"></a>
<a class="sourceLine" id="cb8-49" title="49"><span class="co"># Selecionando um grupo de indivíduos</span></a>
<a class="sourceLine" id="cb8-50" title="50">s &lt;-<span class="st"> </span><span class="kw">sample</span> (<span class="kw">unique</span> (mice<span class="op">$</span>id), <span class="dt">size =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb8-51" title="51"><span class="kw">plot</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time, <span class="dt">data =</span> mice , <span class="dt">col =</span> <span class="st">&quot;gray50&quot;</span>,</a>
<a class="sourceLine" id="cb8-52" title="52">      <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>,</a>
<a class="sourceLine" id="cb8-53" title="53">      <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</a>
<a class="sourceLine" id="cb8-54" title="54"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb8-55" title="55">  <span class="kw">lines</span> (mice<span class="op">$</span>time[mice<span class="op">$</span>id <span class="op">==</span><span class="st"> </span>s[i]],</a>
<a class="sourceLine" id="cb8-56" title="56">         mice<span class="op">$</span>wt[mice<span class="op">$</span>id <span class="op">==</span><span class="st"> </span>s[i]], <span class="dt">lwd =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb8-57" title="57">}</a>
<a class="sourceLine" id="cb8-58" title="58"></a>
<a class="sourceLine" id="cb8-59" title="59"></a>
<a class="sourceLine" id="cb8-60" title="60"><span class="co">## Quantis</span></a>
<a class="sourceLine" id="cb8-61" title="61">mice.lo &lt;-<span class="st"> </span><span class="kw">loess</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time, <span class="dt">span =</span> <span class="fl">0.25</span>, <span class="dt">degree =</span> <span class="dv">1</span>, <span class="dt">data =</span> mice)</a>
<a class="sourceLine" id="cb8-62" title="62">mice<span class="op">$</span>res &lt;-<span class="st"> </span><span class="kw">resid</span> (mice.lo)</a>
<a class="sourceLine" id="cb8-63" title="63"></a>
<a class="sourceLine" id="cb8-64" title="64">aux &lt;-<span class="st"> </span><span class="kw">sort</span> (<span class="kw">tapply</span>(mice<span class="op">$</span>res, mice<span class="op">$</span>id, median))</a>
<a class="sourceLine" id="cb8-65" title="65">aux &lt;-<span class="st"> </span>aux[<span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">round</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">*</span><span class="st"> </span><span class="kw">length</span> (aux) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>))]</a>
<a class="sourceLine" id="cb8-66" title="66">aux &lt;-<span class="st"> </span><span class="kw">as.numeric</span> (<span class="kw">names</span> (aux))</a>
<a class="sourceLine" id="cb8-67" title="67"></a>
<a class="sourceLine" id="cb8-68" title="68">leg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0%&quot;</span>, <span class="st">&quot;25%&quot;</span>, <span class="st">&quot;50%&quot;</span>, <span class="st">&quot;75%&quot;</span>, <span class="st">&quot;100%&quot;</span>)</a>
<a class="sourceLine" id="cb8-69" title="69"><span class="kw">plot</span> (mice<span class="op">$</span>res <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time, <span class="dt">data =</span> mice, <span class="dt">col =</span> <span class="st">&quot;gray70&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;weight&quot;</span>)</a>
<a class="sourceLine" id="cb8-70" title="70"><span class="kw">with</span> (mice,</a>
<a class="sourceLine" id="cb8-71" title="71">      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb8-72" title="72">        subset &lt;-<span class="st"> </span>mice<span class="op">$</span>id <span class="op">==</span><span class="st"> </span>aux[i]</a>
<a class="sourceLine" id="cb8-73" title="73">        <span class="kw">lines</span> (mice<span class="op">$</span>time[subset], mice<span class="op">$</span>res[subset],</a>
<a class="sourceLine" id="cb8-74" title="74">               <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> i)</a>
<a class="sourceLine" id="cb8-75" title="75">        <span class="kw">text</span> (mice<span class="op">$</span>time[subset][<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb8-76" title="76">              mice<span class="op">$</span>res[subset][<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb8-77" title="77">              <span class="dt">labels =</span> leg[i])</a>
<a class="sourceLine" id="cb8-78" title="78">      })</a>
<a class="sourceLine" id="cb8-79" title="79"></a>
<a class="sourceLine" id="cb8-80" title="80"><span class="co">## Relação com outras variáveis</span></a>
<a class="sourceLine" id="cb8-81" title="81"><span class="kw">xyplot</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time<span class="op">|</span><span class="st"> </span>mice<span class="op">$</span>group  , <span class="dt">data =</span> mice, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">group =</span> mice<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb8-82" title="82">        <span class="dt">xlab =</span> <span class="st">&quot;Days&quot;</span>,<span class="dt">col.line =</span> <span class="st">&quot;gray20&quot;</span>,</a>
<a class="sourceLine" id="cb8-83" title="83">        <span class="dt">ylab =</span> <span class="st">&quot;Weight&quot;</span>,<span class="dt">strip =</span> <span class="kw">strip.custom</span> (<span class="dt">var.name =</span> <span class="st">&quot;group&quot;</span>))</a>
<a class="sourceLine" id="cb8-84" title="84"></a>
<a class="sourceLine" id="cb8-85" title="85"><span class="co">## Explorando Correlação</span></a>
<a class="sourceLine" id="cb8-86" title="86">mice.lm &lt;-<span class="st"> </span><span class="kw">lm</span> (mice<span class="op">$</span>wt <span class="op">~</span><span class="st"> </span>mice<span class="op">$</span>time, <span class="dt">data =</span> mice)</a>
<a class="sourceLine" id="cb8-87" title="87">mice<span class="op">$</span>lmres &lt;-<span class="st"> </span><span class="kw">resid</span> (mice.lm)</a>
<a class="sourceLine" id="cb8-88" title="88">mice<span class="op">$</span>roundyr &lt;-<span class="st"> </span><span class="kw">round</span> (mice<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb8-89" title="89"></a>
<a class="sourceLine" id="cb8-90" title="90"></a>
<a class="sourceLine" id="cb8-91" title="91"></a>
<a class="sourceLine" id="cb8-92" title="92"><span class="co">## Transformando em wide -  reshape</span></a>
<a class="sourceLine" id="cb8-93" title="93">micew &lt;-<span class="st"> </span><span class="kw">reshape</span> (mice[,<span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;lmres&quot;</span>, <span class="st">&quot;roundyr&quot;</span>)],</a>
<a class="sourceLine" id="cb8-94" title="94">                 <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>,</a>
<a class="sourceLine" id="cb8-95" title="95">                 <span class="dt">v.names =</span> <span class="st">&quot;lmres&quot;</span>, <span class="dt">timevar =</span> <span class="st">&quot;roundyr&quot;</span>,</a>
<a class="sourceLine" id="cb8-96" title="96">                 <span class="dt">idvar =</span> <span class="st">&quot;id&quot;</span>)</a>
<a class="sourceLine" id="cb8-97" title="97"></a>
<a class="sourceLine" id="cb8-98" title="98">micew[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb8-99" title="99"></a>
<a class="sourceLine" id="cb8-100" title="100"><span class="co">## Histogramas na diagonal</span></a>
<a class="sourceLine" id="cb8-101" title="101">panel.hist &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb8-102" title="102">  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))</a>
<a class="sourceLine" id="cb8-103" title="103">  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(usr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) )</a>
<a class="sourceLine" id="cb8-104" title="104">  h &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-105" title="105">  breaks &lt;-<span class="st"> </span>h<span class="op">$</span>breaks;</a>
<a class="sourceLine" id="cb8-106" title="106">  nB &lt;-<span class="st"> </span><span class="kw">length</span>(breaks)</a>
<a class="sourceLine" id="cb8-107" title="107">  y &lt;-<span class="st"> </span>h<span class="op">$</span>counts;</a>
<a class="sourceLine" id="cb8-108" title="108">  y &lt;-<span class="st"> </span>y<span class="op">/</span><span class="kw">max</span>(y)</a>
<a class="sourceLine" id="cb8-109" title="109">  <span class="kw">rect</span>(breaks[<span class="op">-</span>nB], <span class="dv">0</span>, breaks[<span class="op">-</span><span class="dv">1</span>], y, <span class="dt">col=</span><span class="st">&quot;cyan&quot;</span>, ...)}</a>
<a class="sourceLine" id="cb8-110" title="110"></a>
<a class="sourceLine" id="cb8-111" title="111"><span class="co">## Gráfico super elaborado. As correlações aparecem numa metade da matriz .</span></a>
<a class="sourceLine" id="cb8-112" title="112">panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits=</span><span class="dv">2</span>, <span class="dt">prefix=</span><span class="st">&quot;&quot;</span>, cex.cor) {</a>
<a class="sourceLine" id="cb8-113" title="113">  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))</a>
<a class="sourceLine" id="cb8-114" title="114">  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb8-115" title="115">  r &lt;-<span class="st"> </span><span class="kw">abs</span> (<span class="kw">cor</span>(x, y, <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>))</a>
<a class="sourceLine" id="cb8-116" title="116">  txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits=</span>digits)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-117" title="117">  txt &lt;-<span class="st"> </span><span class="kw">paste</span>(prefix, txt, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb8-118" title="118">  <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)</a>
<a class="sourceLine" id="cb8-119" title="119">  <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex <span class="op">*</span><span class="st"> </span>r)</a>
<a class="sourceLine" id="cb8-120" title="120">}</a>
<a class="sourceLine" id="cb8-121" title="121"><span class="kw">pairs</span> (micew[,<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span><span class="op">:</span><span class="dv">9</span>)], <span class="dt">upper.panel =</span> panel.cor,<span class="dt">diag.panel =</span> panel.hist)</a>
<a class="sourceLine" id="cb8-122" title="122"></a>
<a class="sourceLine" id="cb8-123" title="123"></a>
<a class="sourceLine" id="cb8-124" title="124">micew</a>
<a class="sourceLine" id="cb8-125" title="125"><span class="kw">cor</span>(micew[ , <span class="dv">2</span><span class="op">:</span><span class="dv">21</span>], <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb8-126" title="126"></a>
<a class="sourceLine" id="cb8-127" title="127"></a>
<a class="sourceLine" id="cb8-128" title="128"></a>
<a class="sourceLine" id="cb8-129" title="129"><span class="kw">pairs</span>(<span class="op">~</span>lmres<span class="fl">.0</span><span class="op">+</span>lmres<span class="fl">.1</span><span class="op">+</span>lmres<span class="fl">.3</span><span class="op">+</span>lmres<span class="fl">.9</span><span class="op">+</span>lmres<span class="fl">.15</span><span class="op">+</span>lmres<span class="fl">.18</span>,<span class="dt">data=</span>micew)</a>
<a class="sourceLine" id="cb8-130" title="130"></a>
<a class="sourceLine" id="cb8-131" title="131"><span class="kw">pairs</span>(<span class="op">~</span>lmres<span class="fl">.1</span><span class="op">+</span>lmres<span class="fl">.2</span><span class="op">+</span>lmres<span class="fl">.3</span><span class="op">+</span>lmres<span class="fl">.4</span><span class="op">+</span>lmres<span class="fl">.5</span><span class="op">+</span>lmres<span class="fl">.6</span><span class="op">+</span>lmres<span class="fl">.7</span><span class="op">+</span>lmres<span class="fl">.8</span><span class="op">+</span></a>
<a class="sourceLine" id="cb8-132" title="132"><span class="st">        </span>lmres<span class="fl">.9</span><span class="op">+</span>lmres<span class="fl">.10</span><span class="op">+</span>lmres<span class="fl">.11</span><span class="op">+</span>lmres<span class="fl">.12</span><span class="op">+</span>lmres<span class="fl">.13</span><span class="op">+</span>lmres<span class="fl">.14</span><span class="op">+</span>lmres<span class="fl">.15</span><span class="op">+</span></a>
<a class="sourceLine" id="cb8-133" title="133"><span class="st">        </span>lmres<span class="fl">.16</span><span class="op">+</span>lmres<span class="fl">.17</span><span class="op">+</span>lmres<span class="fl">.18</span><span class="op">+</span>lmres<span class="fl">.19</span>,<span class="dt">data=</span>micew)</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="referências-e-leituras-sugeridas-para-essa-aula.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
